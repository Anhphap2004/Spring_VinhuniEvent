<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{main/layout/base}">
<head>
    <title>Danh Sách Sự Kiện</title>
    <style>
        /* CSS cho thẻ sự kiện */
        .event-card-link {
            display: block;
            text-decoration: none;
            color: inherit;
            height: 100%;
        }

        .event-card {
            border: 1px solid #e9ecef;
            background-color: #ffffff;
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
            border-radius: 0.5rem !important;
            overflow: hidden;
        }

        /* Hiệu ứng Hover */
        .event-card-link:hover .event-card {
            transform: translateY(-5px); /* Hiệu ứng nhấc lên */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15) !important;
        }

        .event-card:hover .event-image {
            transform: scale(1.05); /* Phóng to ảnh nhẹ */
        }

        /* Ảnh */
        .event-img-container {
            height: 200px; /* Chiều cao cố định cho ảnh */
        }

        .event-image {
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .event-date-label {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.85rem;
            z-index: 10;
            background-color: #007bff; /* Đảm bảo màu nền cho nhãn */
        }

        /* Truncate text 2 dòng */
        .text-truncate-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.4;
            max-height: 2.8em;
        }

        /* CSS Sidebar */
        .sidebar-card {
            border: 1px solid #e9ecef;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            background-color: #ffffff;
        }

        .sidebar-card .list-group-item {
            border: none;
            padding: 0.75rem 1rem;
            transition: background-color 0.2s, color 0.2s;
            border-radius: 0;
        }

        .sidebar-card .list-group-item:hover {
            background-color: #f8f9fa;
            color: #007bff;
        }

        .sidebar-card .list-group-item.active {
            background-color: #007bff;
            color: white;
            border-radius: 0;
        }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="container-fluid py-6">
        <div class="container">

            <div class="text-center wow bounceInUp" data-wow-delay="0.1s">
                <small class="d-inline-block fw-bold text-primary text-uppercase bg-light border border-primary rounded-pill px-4 py-1 mb-3">
                    Vinhuni Events
                </small>
                <h1 class="display-5 mb-5">Danh Sách Sự Kiện</h1>
            </div>

            <div class="row g-4">

                <div class="col-lg-3">
                    <div class="sidebar-card shadow-sm p-0 wow fadeInUp" data-wow-delay="0.1s">
                        <h5 class="p-3 mb-0 border-bottom bg-light rounded-top fw-bold text-dark">
                            <i class="fas fa-list me-2 text-primary"></i>Danh Mục Sự Kiện
                        </h5>

                        <div class="list-group list-group-flush">
                            <a th:href="@{/events}"
                               th:classappend="${selectedCategory == null} ? 'active'"
                               class="list-group-item list-group-item-action">
                                Tất Cả Sự Kiện
                            </a>

                            <a th:each="cat : ${eventCategories}"
                               th:href="@{'/events?category=' + ${cat.category_id}}"
                               th:classappend="${selectedCategory != null and selectedCategory.equals(cat.category_id)} ? 'active'"
                               class="list-group-item list-group-item-action">
                                <span th:text="${cat.category_name}">Tên Danh Mục</span>
                                <span th:if="${cat.events != null}" th:text="' (' + ${cat.events.size()} + ')'"> (12)</span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-9">

                    <div th:if="${events.isEmpty()}" class="col-12 text-center py-5">
                        <p class="lead">Hiện tại không có sự kiện nào được tìm thấy trong danh mục này.</p>
                        <a th:href="@{/events/create}" class="btn btn-primary">Tạo Sự Kiện Mới</a>
                    </div>

                    <div class="row g-4">

                        <div class="col-md-6 col-xl-4 wow fadeInUp"
                             th:each="e, i : ${events}"
                             th:attr="data-wow-delay=${0.1 + i.index * 0.2} + 's'">

                            <a th:href="@{'/events/' + ${e.event_id}}" class="event-card-link">
                                <div class="event-card shadow-sm">

                                    <div class="event-img-container overflow-hidden position-relative">
                                        <img class="img-fluid w-100 event-image"
                                             th:src="@{${e.image}}"
                                             alt="Event Image">

                                        <div class="event-date-label text-white text-center rounded-pill py-1 px-3">
                                            <span th:text="${#temporals.format(e.startTime, 'dd MMM')}" class="fw-bold">01 Jan</span>
                                        </div>
                                    </div>

                                    <div class="p-3">
                                        <h5 class="text-dark mb-2 fw-bold text-truncate-2" th:text="${e.title}">Event Title</h5>

                                        <div class="text-muted small">
                                            <p class="mb-1"><i class="far fa-clock me-2" style="color: #007bff;"></i>
                                                <span th:text="${#temporals.format(e.startTime, 'HH:mm')} + ' - ' + ${#temporals.format(e.endTime, 'HH:mm')}">10:00 - 12:00</span>
                                            </p>
                                            <p class="mb-0 text-truncate"><i class="fas fa-map-marker-alt me-2" style="color: #007bff;"></i>
                                                <span th:text="${e.location != null ? e.location : 'Online / TBA'}">Location Detail</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>