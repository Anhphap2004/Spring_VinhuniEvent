<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{main/layout/base}">
<head>
    <title th:text="${event.title} + ' | Chi tiết Sự kiện'"></title>
    <style>
        /* CSS tùy chỉnh cho trang chi tiết */
        .event-detail-header {
            background-color: #f8f9fa; /* Màu nền nhẹ */
            padding: 3rem 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid #e9ecef;
        }

        .event-image-lg {
            width: 100%;
            height: 400px; /* Chiều cao cố định lớn cho ảnh chính */
            object-fit: cover;
            border-radius: 0.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .info-box {
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .event-content p {
            line-height: 1.8;
            color: #495057;
        }

        .detail-section h2 {
            border-bottom: 2px solid #007bff;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            color: #343a40;
        }

        /* CSS cho thông báo */
        .alert-flash {
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: 0.25rem;
        }
        .alert-success {
            color: #0f5132;
            background-color: #d1e7dd;
            border-color: #badbcc;
        }
        .alert-danger {
            color: #842029;
            background-color: #f8d7da;
            border-color: #f5c2c7;
        }

    </style>
</head>
<body>
<div layout:fragment="content">

    <div class="container-fluid event-detail-header">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a th:href="@{/}">Trang chủ</a></li>
                    <li class="breadcrumb-item"><a th:href="@{/events}">Sự kiện</a></li>
                    <li class="breadcrumb-item active" aria-current="page" th:text="${event.title}"></li>
                </ol>
            </nav>
            <h1 class="display-4 fw-bold" th:text="${event.title}">Tên sự kiện</h1>
            <p class="lead text-muted" th:text="${event.description}"></p>
        </div>
    </div>

    <div class="container py-4">

        <div th:if="${successMessage}" class="alert-flash alert-success" th:text="${successMessage}">
            Đăng ký thành công!
        </div>
        <div th:if="${errorMessage}" class="alert-flash alert-danger" th:text="${errorMessage}">
            Có lỗi xảy ra!
        </div>
        <div class="row g-5">

            <div class="col-lg-8">

                <div class="mb-5">
                    <img th:src="@{ ${event.image}}"
                         alt="Hình ảnh sự kiện"
                         class="event-image-lg">
                </div>

                <div class="detail-section mb-5 event-content">
                    <h2 class="fw-bold fs-3"><i class="fas fa-file-alt me-2 text-primary"></i>Mô Tả</h2>
                    <p th:utext="${event.description != null ? event.description : 'Không có mô tả chi tiết.'}"></p>
                </div>

                <div class="detail-section mb-5 event-content">
                    <h2 class="fw-bold fs-3"><i class="fas fa-info-circle me-2 text-primary"></i>Chi Tiết Sự Kiện</h2>
                    <div th:utext="${event.detail != null ? event.detail : 'Thông tin chi tiết đang được cập nhật.'}"></div>
                </div>

                <a th:href="@{/events}" class="btn btn-outline-secondary mt-4">
                    <i class="fas fa-arrow-left me-2"></i>Quay lại danh sách sự kiện
                </a>
            </div>

            <div class="col-lg-4">

                <div class="info-box shadow-sm mb-4">
                    <h5 class="fw-bold text-primary mb-3"><i class="fas fa-calendar-alt me-2"></i>Thông Tin Chung</h5>

                    <ul class="list-unstyled">
                        <li class="mb-3">
                            <span class="fw-bold d-block">Thời Gian</span>
                            <i class="far fa-clock me-2 text-muted"></i>
                            <span th:text="${#temporals.format(event.startTime, 'HH:mm dd/MM/yyyy')}"></span>
                            <span th:if="${event.startTime != event.endTime}">
                                - <span th:text="${#temporals.format(event.endTime, 'HH:mm dd/MM/yyyy')}"></span>
                            </span>
                        </li>

                        <li class="mb-3">
                            <span class="fw-bold d-block">Địa Điểm</span>
                            <i class="fas fa-map-marker-alt me-2 text-muted"></i>
                            <span th:text="${event.location != null ? event.location : 'Đang cập nhật'}"></span>
                        </li>

                        <li class="mb-3">
                            <span class="fw-bold d-block">Số lượng tối đa</span>
                            <i class="fas fa-users me-2 text-muted"></i>
                            <span th:text="${event.max_participants != null ? event.max_participants : 'Không giới hạn'}"></span>
                        </li>

                        <li>
                            <span class="fw-bold d-block">Được tạo bởi</span>
                            <i class="fas fa-user-tie me-2 text-muted"></i>
                            <span th:text="${event.created_by != null ? event.created_by.full_name : 'Quản trị viên'}"></span>
                        </li>
                    </ul>
                </div>
                <div class="mb-4">

                    <div th:if="${isRegistered}" class="alert-flash alert-success text-center">
                        <i class="fas fa-check-circle me-2"></i>Bạn đã đăng ký thành công sự kiện này!
                    </div>

                    <div th:unless="${isRegistered}">
                        <form th:action="@{/events/{id}/register(id=${event.event_id})}" method="post">
                            <button type="submit"
                                    class="btn btn-primary btn-lg w-100 fw-bold shadow-sm"
                                    style="background-color: #dc3545; border-color: #dc3545;">
                                <i class="fas fa-ticket-alt me-2"></i>ĐĂNG KÝ THAM GIA SỰ KIỆN
                            </button>
                        </form>
                    </div>
                </div>
                <div class="info-box mt-4 text-center">
                    <small class="text-muted">Sự kiện bắt đầu sau:</small>
                    <h3 class="fw-bold text-success">07 Ngày 14 Giờ</h3>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>